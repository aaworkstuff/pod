<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TSI Placement Task – Questionnaire Mock (LSC Exemptions)</title>
  <style>
    :root {
      --ps-navy:#2c3e50; --ps-blue:#1b6aa5; --ps-sky:#e8f2fa; --ps-gray:#f5f6f7; --ps-border:#d5dbe0;
      --ps-green:#2e7d32; --ps-red:#c0392b; --ps-text:#212529; --warning:#8a6d1a; --warning-bg:#fff8e1;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Segoe UI, Roboto, Helvetica, Arial, sans-serif;color:var(--ps-text);background:#fff}
    .topbar{display:flex;align-items:center;gap:16px;padding:12px 20px;background:linear-gradient(90deg,var(--ps-navy),#223445);color:#fff}
    .topbar .app-title{font-size:18px;font-weight:600}
    .env-pill{margin-left:auto;font-size:12px;background:#3a5166;padding:4px 10px;border-radius:999px}
    .layout{display:grid;grid-template-columns:260px 1fr;min-height:calc(100vh - 56px)}
    .sidebar{background:var(--ps-gray);border-right:1px solid var(--ps-border);padding:18px}
    .step{display:flex;align-items:flex-start;gap:10px;padding:10px;border-radius:10px;margin-bottom:8px;border:1px solid transparent;cursor:pointer}
    .step.active{background:var(--ps-sky);border-color:var(--ps-border)}
    .step .index{width:26px;height:26px;border-radius:50%;display:grid;place-items:center;background:#fff;border:1px solid var(--ps-border);font-size:12px;font-weight:600}
    .step.active .index{background:var(--ps-blue);color:#fff;border-color:var(--ps-blue)}
    .step .label{font-size:14px}
    .content{padding:24px 28px}
    .card{border:1px solid var(--ps-border);border-radius:12px;background:#fff;box-shadow:0 1px 0 rgba(16,24,40,.02)}
    .card .card-hd{padding:16px 18px;border-bottom:1px solid var(--ps-border);background:linear-gradient(0deg,#fff,var(--ps-gray))}
    .card .card-bd{padding:18px}
    .row{display:grid;gap:16px}
    .row.cols-2{grid-template-columns:1fr 1fr}
    label{font-size:14px;font-weight:600;margin-bottom:6px;display:block}
    .hint{font-size:12px;color:#5c6b78}
    input[type="text"], select{width:100%;padding:10px 12px;border:1px solid var(--ps-border);border-radius:8px;background:#fff}
    .radio-group, .checklist{display:grid;gap:10px}
    .radio, .check{display:flex;align-items:flex-start;gap:8px}
    .actions{display:flex;gap:10px;justify-content:flex-end;padding:18px}
    .btn{appearance:none;border:1px solid var(--ps-border);background:#fff;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .btn.primary{background:var(--ps-blue);border-color:var(--ps-blue);color:#fff}
    .btn.ghost{background:#fff;border-color:var(--ps-border)}
    .btn.success{background:var(--ps-green);border-color:var(--ps-green);color:#fff}
    .btn.danger{background:var(--ps-red);border-color:var(--ps-red);color:#fff}
    .progress{height:8px;background:#eef2f5;border-radius:999px;overflow:hidden;margin-top:10px}
    .progress > div{height:100%;width:0;background:linear-gradient(90deg,var(--ps-blue),#3aa0ff)}
    .summary-list{display:grid;gap:10px}
    .pill{display:inline-flex;align-items:center;gap:6px;font-size:12px;background:#eef7ee;border:1px solid #cfe9d0;color:#1e6f23;border-radius:999px;padding:6px 10px}
    .pill.bad{background:#fff3f2;border-color:#f1d0cd;color:#a63a2e}
    .pill.note{background:var(--warning-bg);border-color:#f1e3a1;color:var(--warning)}
    .muted{color:#6b7b88}
    details{border:1px dashed var(--ps-border);border-radius:8px;padding:10px 12px}
    details > summary{cursor:pointer;font-weight:600}
    .footnote{font-size:12px;color:#5c6b78;margin-top:14px}
    @media(max-width:960px){.layout{grid-template-columns:1fr}.sidebar{position:sticky;top:0;z-index:2}}
  </style>
</head>
<body>
  <header class="topbar">
    <div style="display:flex;align-items:center;gap:10px">
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.77 5.82 22 7 14.14l-5-4.87 6.91-1.01L12 2z" fill="#7fb3d5"/></svg>
      <div class="app-title">Campus Solutions – Questionnaire Framework Mock</div>
    </div>
    <div class="env-pill">Demo · No backend</div>
  </header>

  <main class="layout">
    <aside class="sidebar" id="sidebar"></aside>
    <section class="content">
      <div class="card">
        <div class="card-hd">
          <div style="display:flex;align-items:center;justify-content:space-between;gap:12px">
            <div>
              <div style="font-weight:700" id="view-title">Loading…</div>
              <div class="progress"><div id="progress-bar"></div></div>
            </div>
            <button class="btn ghost" id="resetBtn" title="Reset all answers">Reset</button>
          </div>
        </div>
        <div class="card-bd" id="view-container"></div>
        <div class="actions">
          <button class="btn ghost" id="backBtn">Back</button>
          <button class="btn primary" id="nextBtn">Next</button>
        </div>
      </div>
      <div class="footnote">This mock uses Lone Star College's published TSI exemptions. For demo only.</div>
    </section>
  </main>

  <script>
    // ---------------------------
    // State
    // ---------------------------
    const state = {
      stepIndex: 0,
      // CS milestone flags (simulate): Y satisfied, N not satisfied
      milestones: { TSIR: 'N', TSIW: 'N', TISM: 'N' },
      answers: {
        reading: { selections: {}, decided: false },
        writing: { selections: {}, decided: false },
        math:    { selections: {}, decided: false },
      }
    };

    // Static text based on LSC page
    const EXPLAINS = {
      degree: 'You are exempt if you have graduated with an associate or baccalaureate degree from a U.S. Department of Education accredited postsecondary institution.',
      transfer: 'You are exempt if you transferred to LSC from a private, independent, or accredited out-of-state institution and have satisfactorily completed college-level coursework.',
      priorReady: 'You are exempt if a prior college has already determined that you met college readiness standards.',
      activeDuty: 'You are exempt if you are serving on active duty in the U.S. armed forces, Texas National Guard, or a reserve component for at least three years preceding enrollment.',
      veteran: 'You are exempt if you were honorably discharged, retired, or released from active duty on or after August 1, 1990.',
      cpp: 'You are exempt in the content area if you successfully completed a college preparatory course through an LSC-partnered school district. Exemption lasts 24 months from high school graduation and requires enrolling in the first college-level course in that area in the first year at LSC.',
      nonDegree: 'Non-degree seeking students are TSI exempt.'
    };

    // Test-score options by area (thresholds copied from LSC page)
    const TESTS = {
      readingWriting: [
        { key:'act_rw_old', label:'ACT English 19 and Composite 23 (administered before Feb 15, 2023)', type:'check' },
        { key:'act_rw_new', label:'ACT English and Reading (E+R) 40 or higher (administered on/after Feb 15, 2023)', type:'check' },
        { key:'sat_rw',     label:'SAT Evidenced-Based Reading and Writing 480 or higher', type:'check' },
        { key:'ged_rw',     label:'GED Reasoning Through Language Arts 165 or higher', type:'check' },
        { key:'hiset_rw',   label:'HiSET Reading 15 and Writing 15 with Essay score 4 or higher', type:'check' },
        { key:'staar_eng3', label:'STAAR English III Level 2 score of 4000', type:'check' },
      ],
      math: [
        { key:'act_m_old', label:'ACT Math 19 and Composite 23 (administered before Feb 15, 2023)', type:'check' },
        { key:'act_m_new', label:'ACT Math 22 or higher (administered on/after Feb 15, 2023)', type:'check' },
        { key:'sat_m',     label:'SAT Math 530 or higher', type:'check' },
        { key:'ged_m',     label:'GED Mathematical Reasoning 165 or higher', type:'check' },
        { key:'hiset_m',   label:'HiSET Mathematical Reasoning 15 or higher', type:'check' },
        { key:'staar_alg2',label:'STAAR Algebra II Level 2 score of 4000', type:'check' },
      ]
    };

    const stepsStatic = [
      { key: 'intro',   label: 'Introduction' },
      { key: 'profile', label: 'Student flags' },
    ];

    function computeDynamicSteps(){
      const dyn = [];
      if (state.milestones.TSIR === 'N' || state.milestones.TSIW === 'N') dyn.push({ key:'rw_exempt', label:'Reading and Writing exemptions' });
      if (state.milestones.TISM === 'N') dyn.push({ key:'m_exempt', label:'Math exemptions' });
      dyn.push({ key:'summary', label:'Summary' });
      return [...stepsStatic, ...dyn];
    }

    // ---------------------------
    // Render helpers
    // ---------------------------
    const viewTitle = document.getElementById('view-title');
    const viewContainer = document.getElementById('view-container');
    const sidebar = document.getElementById('sidebar');
    const progressBar = document.getElementById('progress-bar');
    const backBtn = document.getElementById('backBtn');
    const nextBtn = document.getElementById('nextBtn');
    const resetBtn = document.getElementById('resetBtn');

    function renderSidebar(){
      const all = computeDynamicSteps();
      sidebar.innerHTML = '';
      all.forEach((s, idx)=>{
        const el = document.createElement('div');
        el.className = 'step' + (idx === state.stepIndex ? ' active' : '');
        el.innerHTML = `<div class="index">${idx+1}</div><div class="label">${s.label}</div>`;
        el.addEventListener('click', ()=>{ state.stepIndex = idx; render(); });
        sidebar.appendChild(el);
      });
    }

    function setProgress(){
      const total = computeDynamicSteps().length;
      progressBar.style.width = (((state.stepIndex+1)/total)*100) + '%';
    }

    function render(){
      const stepsNow = computeDynamicSteps();
      const current = stepsNow[state.stepIndex];
      renderSidebar(); setProgress();
      viewTitle.textContent = current.label;
      switch(current.key){
        case 'intro': renderIntro(); break;
        case 'profile': renderProfile(); break;
        case 'rw_exempt': renderExemptions('rw'); break;
        case 'm_exempt': renderExemptions('m'); break;
        case 'summary': renderSummary(); break;
      }
      backBtn.disabled = state.stepIndex === 0;
      nextBtn.textContent = current.key === 'summary' ? 'Finish' : 'Next';
    }

    // ---------------------------
    // Views
    // ---------------------------
    function renderIntro(){
      viewContainer.innerHTML = `
        <div class="row" style="gap:18px">
          <div>
            <p>This demo walks a student through <strong>TSI exemptions</strong> exactly as published by Lone Star College. It branches per content area and ends with a clear next step.</p>
            <ul>
              <li>Reading and Writing are grouped together where rules are identical.</li>
              <li>Math is handled separately.</li>
            </ul>
            <details><summary>What counts as an exemption?</summary>
              <div class="hint">Degree earned, transfer with college-level coursework, prior readiness determination, certain military statuses, completion of a partnered college prep course, non-degree seeking, or meeting specific test-score thresholds on ACT, SAT, GED, HiSET, or STAAR.</div>
            </details>
            <p class="muted">No real data is stored. This is for presentation only.</p>
          </div>
        </div>`;
    }

    function renderProfile(){
      const { TSIR, TSIW, TISM } = state.milestones;
      viewContainer.innerHTML = `
        <div class="row cols-2">
          <div>
            <label for="tsir">TSIR – Reading satisfied?</label>
            <select id="tsir">
              <option value="N" ${TSIR==='N'?'selected':''}>N – Not satisfied</option>
              <option value="Y" ${TSIR==='Y'?'selected':''}>Y – Satisfied</option>
            </select>
            <div class="hint">If set to N, Reading and Writing exemptions will be asked.</div>
          </div>
          <div>
            <label for="tsiw">TSIW – Writing satisfied?</label>
            <select id="tsiw">
              <option value="N" ${TSIW==='N'?'selected':''}>N – Not satisfied</option>
              <option value="Y" ${TSIW==='Y'?'selected':''}>Y – Satisfied</option>
            </select>
            <div class="hint">If set to N, Reading and Writing exemptions will be asked.</div>
          </div>
          <div>
            <label for="tism">TISM – Math satisfied?</label>
            <select id="tism">
              <option value="N" ${TISM==='N'?'selected':''}>N – Not satisfied</option>
              <option value="Y" ${TISM==='Y'?'selected':''}>Y – Satisfied</option>
            </select>
            <div class="hint">If set to N, Math exemptions will be asked.</div>
          </div>
          <div>
            <label>Load sample student</label>
            <div class="row" style="grid-template-columns: 1fr 1fr 1fr; gap:8px">
              <button class="btn" onclick="loadSample('needsAll')">Needs all</button>
              <button class="btn" onclick="loadSample('mathOnly')">Math only</button>
              <button class="btn" onclick="loadSample('none')">All satisfied</button>
            </div>
          </div>
        </div>`;

      document.getElementById('tsir').addEventListener('change', e=>{ state.milestones.TSIR = e.target.value; clampStep(); render(); });
      document.getElementById('tsiw').addEventListener('change', e=>{ state.milestones.TSIW = e.target.value; clampStep(); render(); });
      document.getElementById('tism').addEventListener('change', e=>{ state.milestones.TISM = e.target.value; clampStep(); render(); });
    }

    function renderExemptions(which){
      const isRW = which==='rw';
      const areaLabel = isRW ? 'Reading and Writing' : 'Math';
      const areaKey = isRW ? 'reading' : 'math';
      const testList = isRW ? TESTS.readingWriting : TESTS.math;
      const sel = state.answers[areaKey].selections;

      viewContainer.innerHTML = `
        <div class="row" style="gap:18px">
          <div>
            <p>Answer the questions below to see if you are <strong>TSI-exempt in ${areaLabel}</strong>. If none apply, you will need to take the TSIA2 ${isRW ? '' : 'Math '}assessment.</p>
          </div>

          <details open>
            <summary>College enrollment or completion</summary>
            <div class="checklist">
              ${makeCheck('degree', 'I have an associate or bachelor\'s degree', sel.degree)}
              <div class="hint">${EXPLAINS.degree}</div>
              ${makeCheck('transfer', 'I transferred in with completed college-level coursework', sel.transfer)}
              <div class="hint">${EXPLAINS.transfer}</div>
              ${makeCheck('priorReady', 'A prior college already determined I was college ready', sel.priorReady)}
              <div class="hint">${EXPLAINS.priorReady}</div>
              ${makeCheck('nonDegree', 'I am a non-degree seeking student', sel.nonDegree)}
              <div class="hint">${EXPLAINS.nonDegree}</div>
            </div>
          </details>

          <details>
            <summary>Military status</summary>
            <div class="checklist">
              ${makeCheck('activeDuty', 'I have served on active duty for at least 3 years preceding enrollment', sel.activeDuty)}
              <div class="hint">${EXPLAINS.activeDuty}</div>
              ${makeCheck('veteran', 'I was honorably discharged, retired, or released on or after Aug 1, 1990', sel.veteran)}
              <div class="hint">${EXPLAINS.veteran}</div>
            </div>
          </details>

          <details>
            <summary>College preparatory course</summary>
            <div class="checklist">
              ${makeCheck('cpp', 'I completed a partnered high school College Preparatory Course in this subject within 24 months of HS graduation', sel.cpp)}
              <div class="hint">${EXPLAINS.cpp}</div>
            </div>
          </details>

          <details>
            <summary>Test score options (${areaLabel})</summary>
            <div class="checklist">
              ${testList.map(t => makeCheck(t.key, t.label, sel[t.key])).join('')}
            </div>
          </details>

          <div>
            ${exemptionDecision(areaKey) ? '<div class="pill">Exemption applies in '+areaLabel+'</div>' : '<div class="pill bad">No exemptions selected</div>'}
            <div class="hint">You can select more than one if multiple apply.</div>
          </div>

          <div class="pill note">If no exemptions apply in ${areaLabel}, you will need to take the TSIA2 ${isRW ? 'Reading and Writing' : 'Math'} assessment before registration.</div>
        </div>`;

      // wire up all checkboxes
      viewContainer.querySelectorAll('input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', e => {
          const key = e.target.dataset.key;
          state.answers[areaKey].selections[key] = e.target.checked;
        });
      });
    }

    function renderSummary(){
      const needRW = (state.milestones.TSIR==='N' || state.milestones.TSIW==='N');
      const needM = state.milestones.TISM==='N';
      const rwExempt = needRW ? exemptionDecision('reading') : true;
      const mExempt = needM ? exemptionDecision('math') : true;

      const rows = [];
      if (needRW){ rows.push(summaryRow('Reading and Writing', rwExempt)); }
      if (needM){ rows.push(summaryRow('Math', mExempt)); }

      const allGood = rows.length===0 || rows.every(r => r.ok);

      viewContainer.innerHTML = `
        <div class="summary-list">
          ${rows.map(r => r.html).join('') || '<div class="muted">All areas are already satisfied.</div>'}
        </div>
        <div style="margin-top:16px">
          ${allGood ? '<div class="pill" style="background:#eef7ff;border-color:#cfe1ff;color:#1b6aa5">Ready to register</div>' : '<div class="pill bad">Action needed before registration</div>'}
        </div>`;
    }

    // ---------------------------
    // Helpers
    // ---------------------------
    function makeCheck(key, label, checked){
      return `<label class="check"><input type="checkbox" data-key="${key}" ${checked? 'checked':''}> <span>${label}</span></label>`;
    }

    function exemptionDecision(areaKey){
      const sel = state.answers[areaKey].selections || {};
      // If any exemption is selected for the area, they are exempt in that area
      return Object.values(sel).some(Boolean);
    }

    function summaryRow(label, ok){
      return {
        ok,
        html: `<div style="border:1px solid var(--ps-border);border-radius:10px;padding:12px 14px">
          <div style="display:flex;align-items:center;justify-content:space-between"><strong>${label}</strong>
            ${ok ? '<span class="pill">Exemption applies</span>' : '<span class="pill bad">No exemption selected · TSIA2 required</span>'}
          </div>
        </div>`
      };
    }

    function loadSample(which){
      if (which==='needsAll'){
        state.milestones = { TSIR:'N', TSIW:'N', TISM:'N' };
      } else if (which==='mathOnly'){
        state.milestones = { TSIR:'Y', TSIW:'Y', TISM:'N' };
      } else if (which==='none'){
        state.milestones = { TSIR:'Y', TSIW:'Y', TISM:'Y' };
      }
      state.answers = { reading:{selections:{}}, writing:{selections:{}}, math:{selections:{}} };
      state.stepIndex = 1;
      render();
    }

    function clampStep(){
      const total = computeDynamicSteps().length;
      if (state.stepIndex > total-1){ state.stepIndex = total-1; }
    }

    // Nav
    document.getElementById('backBtn').addEventListener('click', ()=>{ if (state.stepIndex>0){ state.stepIndex--; render(); }});
    document.getElementById('nextBtn').addEventListener('click', ()=>{
      const stepsNow = computeDynamicSteps();
      if (stepsNow[state.stepIndex].key === 'summary'){
        alert('Demo complete. In production, submission would record exemption or testing requirement.');
        return;
      }
      if (state.stepIndex < stepsNow.length-1){ state.stepIndex++; render(); }
    });
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      if (!confirm('Reset all selections?')) return;
      state.stepIndex = 0;
      state.milestones = { TSIR:'N', TSIW:'N', TISM:'N' };
      state.answers = { reading:{selections:{}}, writing:{selections:{}}, math:{selections:{}} };
      render();
    });

    // Kickoff
    render();
  </script>
</body>
</html>
